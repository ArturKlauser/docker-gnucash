# <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/GnuCash_logo.svg/500px-GnuCash_logo.svg.png" width="64" align="absbottom" alt="GnuCash Logo"> Docker container for GnuCash

[![Build Status](https://img.shields.io/github/actions/workflow/status/arturklauser/docker-gnucash/build.yml?branch=main&style=for-the-badge)](https://github.com/arturklauser/docker-gnucash/actions/workflows/build.yml)
[![Docker Image Size](https://img.shields.io/docker/image-size/arturklauser/gnucash/latest?style=for-the-badge)](https://hub.docker.com/repository/docker/arturklauser/gnucash/)

This project provides a Docker container for
<a href="https://www.gnucash.org/">GnuCash</a>.

The graphical user interface (GUI) of the application can be accessed through a
modern web browser, requiring no installation or configuration on the client
side. Only secure access via HTTPS is supported.

The docker image is based on
[jlesage/docker-baseimage-gui](https://github.com/jlesage/docker-baseimage-gui).

> [!NOTE]
> This Docker container is entirely unofficial and not made by the creators of
> GnuCash.

## Features

*   **Versions**: Runs GnuCash 5.13 on baseimage-gui:ubuntu-24.04-v4.
*   **Web Interface**: Access the GnuCash GUI through your web browser.
*   **Secure Access**: Web interface is forced to HTTPS.
*   **Multi-Arch**: Supports `linux/amd64` and `linux/arm64`.
*   **Persistence**: Configuration and data are persisted to volumes.

## Usage

### Docker Compose

1.  Clone this repository:
    ```bash
    git clone https://github.com/ArturKlauser/docker-gnucash.git
    cd docker-gnucash
    ```
1.  Create the data directories:
    ```bash
    mkdir config data
    ```
1.  Run the container:
    ```bash
    USER_ID=$(id -u) GROUP_ID=$(id -g) docker compose up -d
    ```
1.  Access the interface at [https://localhost:5800](https://localhost:5800).
    *  Note: Since a self-signed certificate is generated by default, you will
       see a security warning in your browser. To avoid this, install your own
       certificate in `/config/certs`.
1.  Shut down the container:<br>
    The container is designed to keep running. But if you want to shut it down,
    remember to first quit GnuCash in the GUI to release the lock on the data
    file. Then run:
    ```bash
    USER_ID=$(id -u) GROUP_ID=$(id -g) docker down
    ```

### Docker CLI

```bash
# For DockerHub released image:
IMAGE=arturklauser/gnucash:baseimage-gui-ubuntu-24.04-v4-gnucash-5.13

# For locally built image:
IMAGE=gnucash

docker run -d \
    --name=gnucash \
    -p 5800:5800 \
    -v $(pwd)/config:/config:rw \
    -v $(pwd)/data:/data:rw \
    -e USER_ID=$(id -u) \
    -e GROUP_ID=$(id -g) \
    "${IMAGE}"
```

## Security

*   **HTTPS**: The container enforces HTTPS for the web interface. Accesses to
    the regular HTTP port are redirected to HTTPS.
*   **VNC**: The raw VNC port (5900) from `docker-baseimage-gui` is **not**
    exposed to the host to prevent unencrypted access. Access is intended solely
    through the secure web proxy on port 5800.

## Configuration

### Environment Variables used by Docker Compose

| Variable | Description | Default |
| :--- | :--- | :--- |
| `USER_ID` | User ID of the user running the application. | unset - must be set on command line|
| `GROUP_ID` | Group ID of the user running the application. | unset - must be set on command line|
| `TZ` | Timezone (e.g., `America/New_York`). | `America/Los_Angeles` |
| `CONFIG_DIR` | Host path for the application configuration directory. | `./config` |
| `DATA_DIR` | Host path for the GnuCash data files directory. | `./data` |

### Volumes

| Volume | Description |
| :--- | :--- |
| `/config` | Stores application configuration, including generated SSL certificates (in `/config/certs`). |
| `/data` | Stores GnuCash data files. |

## Local Image Build

To build the image locally:
```bash
docker build --build-arg BASEIMAGE_VERSION=ubuntu-24.04-v4 --build-arg GNUCASH_VERSION=5.13 -t gnucash .
```

To run the locally built image:
```bash
USER_ID=$(id -u) GROUP_ID=$(id -g) IMAGE=gnucash docker compose up -d
```
